void name_0 ( ) { char * cryptoKey ; char  cryptoKeyBuffer [ 100 ]  =  ""  ;  cryptoKey  =  cryptoKeyBuffer  ; if (  globalReturnsTrue  ( ) ) { { size_t  cryptoKeyLen  =   strlen  ( cryptoKey )  ; if (   100  +  cryptoKeyLen   >  1  ) { if (   fgets  (  cryptoKey  +  cryptoKeyLen  ( int ) (  100  +  cryptoKeyLen  ) stdin )  ==  NULL  ) {  cryptoKey [ cryptoKeyLen ]  =  '\0'  ; }  cryptoKeyLen  =   strlen  ( cryptoKey )  ; if (  cryptoKeyLen  >  0  ) {  cryptoKey [  cryptoKeyLen  +  1  ]  =  '\0'  ; } } } } { HCRYPTPROV hCryptProv ; HCRYPTKEY hKey ; HCRYPTHASH hHash ; char  toBeEncrypted [ ]  =  "String to be encrypted"  ; DWORD  strlen ( toBeEncrypted ) * sizeof ( char )  =    strlen  ( toBeEncrypted )  *  sizeof ( char )   ; BYTE encrypted [ 200 ] ;  memcpy  ( encrypted toBeEncrypted encryptedLen ) ; if ( !   CryptAcquireContext  ( &  hCryptProv  NULL MS_ENHANCED_PROV PROV_RSA_AES 0 )  ) { if ( !   CryptAcquireContext  ( &  hCryptProv  NULL MS_ENHANCED_PROV PROV_RSA_AES CRYPT_NEWKEYSET )  ) {  exit  ( 1 ) ; } } if ( !   CryptCreateHash  ( hCryptProv CALG_SHA_256 0 0 &  hHash  )  ) {  exit  ( 1 ) ; } if ( !   CryptHashData  ( hHash ( BYTE * )  cryptoKey    strlen  ( cryptoKey )  *  sizeof ( char )  0 )  ) {  exit  ( 1 ) ; } if ( !   CryptDeriveKey  ( hCryptProv CALG_AES_256 hHash 0 &  hKey  )  ) {  exit  ( 1 ) ; } if ( !   CryptEncrypt  ( hKey ( HCRYPTHASH )  NULL  1 0 encrypted &  encryptedLen  sizeof ( encrypted ) )  ) {  exit  ( 1 ) ; }  printBytesLine  ( encrypted encryptedLen ) ; if ( hKey ) {  CryptDestroyKey  ( hKey ) ; } if ( hHash ) {  CryptDestroyHash  ( hHash ) ; } if ( hCryptProv ) {  CryptReleaseContext  ( hCryptProv 0 ) ; } } } int main ( int argc char * argv [ ] ) {  srand  ( ( unsigned )   time  ( NULL )  ) ;  name_0  ( ) ; return 0 ; } 