void name_0 ( ) { switch ( 6 ) { case 6 : { BYTE payload [ 200 ] ; DWORD  payloadLen  =   strlen  ( PAYLOAD )  ; HCRYPTPROV  hCryptProv  =  ( HCRYPTPROV )  NULL   ; HCRYPTHASH  hHash  =  ( HCRYPTHASH )  NULL   ; HCRYPTKEY  hKey  =  ( HCRYPTKEY )  NULL   ; do {  memcpy  ( payload PAYLOAD payloadLen ) ; if ( !   CryptAcquireContext  ( &  hCryptProv  NULL MS_ENHANCED_PROV PROV_RSA_FULL 0 )  ) { if ( !   CryptAcquireContext  ( &  hCryptProv  NULL MS_ENHANCED_PROV PROV_RSA_FULL CRYPT_NEWKEYSET )  ) {  exit  ( 1 ) ; } } if ( !   CryptCreateHash  ( hCryptProv CALG_SHA_256 0 0 &  hHash  )  ) {  exit  ( 1 ) ; } if ( !   CryptHashData  ( hHash ( BYTE * )  HASH_INPUT    strlen  ( HASH_INPUT )  *  sizeof ( char )  0 )  ) {  exit  ( 1 ) ; } if ( !   CryptDeriveKey  ( hCryptProv CALG_RSA_SIGN hHash 0 &  hKey  )  ) {  exit  ( 1 ) ; } if ( !   CryptEncrypt  ( hKey ( HCRYPTHASH )  NULL  1 CRYPT_OAEP ( BYTE * )  payload  &  payloadLen  sizeof ( payload ) )  ) {  exit  ( 1 ) ; } } while ( 0 ) ; if ( hKey ) {  CryptDestroyKey  ( hKey ) ; } if ( hHash ) {  CryptDestroyHash  ( hHash ) ; } if ( hCryptProv ) {  CryptReleaseContext  ( hCryptProv 0 ) ; }  printBytesLine  ( ( BYTE * )  payload  payloadLen ) ; } break ; default : break ; } } int main ( int argc char * argv [ ] ) {  srand  ( ( unsigned )   time  ( NULL )  ) ;  name_0  ( ) ; return 0 ; } 