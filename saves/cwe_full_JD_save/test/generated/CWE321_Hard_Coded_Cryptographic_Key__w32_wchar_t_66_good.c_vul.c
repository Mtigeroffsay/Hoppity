void name_0 ( wchar_t * cryptoKeyArray [ ] ) { wchar_t  * cryptoKey  =  cryptoKeyArray [ 2 ]  ; { HCRYPTPROV hCryptProv ; HCRYPTKEY hKey ; HCRYPTHASH hHash ; wchar_t toBeEncrypted [ ] = L "String to be encrypted" ; DWORD  wcslen ( toBeEncrypted ) * sizeof ( wchar_t )  =    wcslen  ( toBeEncrypted )  *  sizeof ( wchar_t )   ; BYTE encrypted [ 200 ] ;  memcpy  ( encrypted toBeEncrypted encryptedLen ) ; if ( !   CryptAcquireContext  ( &  hCryptProv  NULL MS_ENHANCED_PROV PROV_RSA_AES 0 )  ) { if ( !   CryptAcquireContext  ( &  hCryptProv  NULL MS_ENHANCED_PROV PROV_RSA_AES CRYPT_NEWKEYSET )  ) {  exit  ( 1 ) ; } } if ( !   CryptCreateHash  ( hCryptProv CALG_SHA_256 0 0 &  hHash  )  ) {  exit  ( 1 ) ; } if ( !   CryptHashData  ( hHash ( BYTE * )  cryptoKey    wcslen  ( cryptoKey )  *  sizeof ( wchar_t )  0 )  ) {  exit  ( 1 ) ; } if ( !   CryptDeriveKey  ( hCryptProv CALG_AES_256 hHash 0 &  hKey  )  ) {  exit  ( 1 ) ; } if ( !   CryptEncrypt  ( hKey ( HCRYPTHASH )  NULL  1 0 encrypted &  encryptedLen  sizeof ( encrypted ) )  ) {  exit  ( 1 ) ; }  printBytesLine  ( encrypted encryptedLen ) ; if ( hKey ) {  CryptDestroyKey  ( hKey ) ; } if ( hHash ) {  CryptDestroyHash  ( hHash ) ; } if ( hCryptProv ) {  CryptReleaseContext  ( hCryptProv 0 ) ; } } } void name_1 ( ) { wchar_t * cryptoKey ; wchar_t * cryptoKeyArray [ 5 ] ; wchar_t cryptoKeyBuffer [ 100 ] = L "" ;  cryptoKey  =  cryptoKeyBuffer  ;  wcscpy  ( cryptoKey CRYPTO_KEY ) ;  cryptoKeyArray [ 2 ]  =  cryptoKey  ;  name_0  ( cryptoKeyArray ) ; } int main ( int argc char * argv [ ] ) {  srand  ( ( unsigned )   time  ( NULL )  ) ;  name_1  ( ) ; return 0 ; } 