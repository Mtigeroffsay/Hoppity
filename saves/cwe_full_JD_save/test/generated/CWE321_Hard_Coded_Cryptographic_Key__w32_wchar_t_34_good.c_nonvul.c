void name_0 ( ) { wchar_t * cryptoKey ; CWE321_Hard_Coded_Cryptographic_Key__w32_wchar_t_34_unionType myUnion ; wchar_t cryptoKeyBuffer [ 100 ] = L "" ;  cryptoKey  =  cryptoKeyBuffer  ; { size_t  cryptoKeyLen  =   wcslen  ( cryptoKey )  ; if (   100  +  cryptoKeyLen   >  1  ) { if (   fgetws  (  cryptoKey  +  cryptoKeyLen  ( int ) (  100  +  cryptoKeyLen  ) stdin )  ==  NULL  ) { cryptoKey [ cryptoKeyLen ] = L '\0' ; }  cryptoKeyLen  =   wcslen  ( cryptoKey )  ; if (  cryptoKeyLen  >  0  ) { cryptoKey [ cryptoKeyLen - 1 ] = L '\0' ; } } }   myUnion  .  unionFirst   =  cryptoKey  ; { wchar_t  * cryptoKey  =   myUnion  .  unionSecond   ; { HCRYPTPROV hCryptProv ; HCRYPTKEY hKey ; HCRYPTHASH hHash ; wchar_t toBeEncrypted [ ] = L "String to be encrypted" ; DWORD  wcslen ( toBeEncrypted ) * sizeof ( wchar_t )  =    wcslen  ( toBeEncrypted )  *  sizeof ( wchar_t )   ; BYTE encrypted [ 200 ] ;  memcpy  ( encrypted toBeEncrypted encryptedLen ) ; if ( !   CryptAcquireContext  ( &  hCryptProv  NULL MS_ENHANCED_PROV PROV_RSA_AES 0 )  ) { if ( !   CryptAcquireContext  ( &  hCryptProv  NULL MS_ENHANCED_PROV PROV_RSA_AES CRYPT_NEWKEYSET )  ) {  exit  ( 1 ) ; } } if ( !   CryptCreateHash  ( hCryptProv CALG_SHA_256 0 0 &  hHash  )  ) {  exit  ( 1 ) ; } if ( !   CryptHashData  ( hHash ( BYTE * )  cryptoKey    wcslen  ( cryptoKey )  *  sizeof ( wchar_t )  0 )  ) {  exit  ( 1 ) ; } if ( !   CryptDeriveKey  ( hCryptProv CALG_AES_256 hHash 0 &  hKey  )  ) {  exit  ( 1 ) ; } if ( !   CryptEncrypt  ( hKey ( HCRYPTHASH )  NULL  1 0 encrypted &  encryptedLen  sizeof ( encrypted ) )  ) {  exit  ( 1 ) ; }  printBytesLine  ( encrypted encryptedLen ) ; if ( hKey ) {  CryptDestroyKey  ( hKey ) ; } if ( hHash ) {  CryptDestroyHash  ( hHash ) ; } if ( hCryptProv ) {  CryptReleaseContext  ( hCryptProv 0 ) ; } } } } int main ( int argc char * argv [ ] ) {  srand  ( ( unsigned )   time  ( NULL )  ) ;  name_0  ( ) ; return 0 ; } 